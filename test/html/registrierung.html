<!DOCTYPE html>
<head>
	<title>InfoWall -- Registrierung</title>
	<meta http-equiv="content-type" content="text/html;charset=utf-8" />
	<meta name="generator" content="Geany 1.23.1" />
	<meta name="viewport" content="width=device-width">
	<link rel="stylesheet" href="/forms.css">
	<link rel="stylesheet" href="/radio_block.css">
	
	<script type="text/javascript">
var name_correct=false;

function ShowAcronym(it){
	var acr=document.getElementById('acronym');
	if ( it.id == "teacher" ){
		acr.readOnly = false;
		acr.style.display = 'inline-block';
	}
	if ( it.id == "pupil" ){
		acr.readOnly = true;
		acr.value="";
		acr.style.display = 'none';
	}
}

function ShowDat(it, dat_id){
	var dat=document.getElementById(dat_id);
	if(name_correct){
		if(it.checked == true){
			dat.style.display = 'inline-block';
		}else{
			dat.style.display = 'none';
		}
	}else{
		alert("Geben Sie einen korrekten Namen ein!");
		it.checked = false;
		dat.style.display = 'none';
	}
}

function CheckIfUserExists()
{
	var rawFile = new XMLHttpRequest();
	rawFile.open("GET", '/cgi-bin/users.cgi', false);
	rawFile.onreadystatechange = function ()
	{
		if(rawFile.readyState === 4)
		{
			if(rawFile.status === 200 || rawFile.status == 0)
			{
				var allText = rawFile.responseText;
				var names = allText.split("\n");
				if(document.getElementById('UserName').value.match(/\S/)){
					if(allText.indexOf(document.getElementById('UserName').value+'\n') >0){
						alert("Name existiert" + '\n' + allText + '\n' + names.length);
						document.getElementById('UserName').style.border= "2px solid red";
					}else{
						document.getElementById('UserName').style.border= "2px solid green";
						name_correct=true;
					}
				 }
				//alert(allText);
			}
		}
	}
	rawFile.send(null);
}

	</script>
	
</head>

<body onload="javascript:ShowAcronym(document.getElementById('pupil')); document.getElementById('register').style.display='none';">
	<div id="login-form">
	<form  method="post" action="/cgi-bin/register.cgi" style="border-radius: 1em; padding: 1em;" autocomplete="off">
		<p>Geben sie Ihre Personendaten ein!</p>
		<input id="UserName" class="textIn" placeholder="Name" name="name" type="text" onblur="CheckIfUserExists()" required />
		<!-- <br>
		<input class="textIn" placeholder="E-Mail" name="mail" type="text" required />
		<br>
		<input class="textIn" placeholder="Kurse" name="kurs" type="text" required />
		<br>
		<input class="textIn" placeholder="Kürzel" name="k&uuml;rzel" type="text" required /> -->
		<br>
		<input type="radio" onclick="javascript:ShowAcronym(this);" id="teacher" name="teach" value="true"><label for="teacher">Lehrer</label></input>
		<input type="radio" onclick="javascript:ShowAcronym(this);" id="pupil" name="teach" value="false" checked="checked"><label for="pupil">Schüler</label></input>
		<input id="acronym" class="textIn" placeholder="Kürzel" name="acronym" type="text" required />
		<br>
		<input class="textIn" placeholder="Passwort (bitte gut!)" name="pass" type="password" required />
		<br>
		<input onclick="ShowDat(this, 'register');" id="acceptTOS" name="acceptTOS" type="checkbox"><label for="acceptTOS"><a href="/tos.html">Nutzungsbedingungen</a> gelesen und akzeptiert</label>
		<br>
		<button class="submitButton" type="submit" id="register">Registrieren</button>
	</form>
	<a href="/index.html" class="gradient-button">Zur&uuml;ck</a>
	</div>
</body>
</html>
